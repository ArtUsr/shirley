
# 简明Excel VBA:whale:

## TODO
- [x] 提纲
- [x] 文档列表
- [ ] 语法说明
- [ ] 参考资料
- [ ] 若雨化

## 0x00 文档列表
- [Excel VBA 参考,官方文档,适用2013及以上](https://msdn.microsoft.com/zh-cn/library/ee861528.aspx)
- [Excel宏教程 (宏的介绍与基本使用)](http://blog.csdn.net/lyhdream/article/details/9060801)
- [Excel2010中的VBA入门,官方文档](https://msdn.microsoft.com/zh-cn/library/office/ee814737(v=office.14).aspx)
- [Excel VBA的一些书籍资源,百度网盘](https://pan.baidu.com/s/1c28fQqW)
- [Excel 函数速查手册](https://support.office.com/zh-cn/article/Excel-%E5%87%BD%E6%95%B0%EF%BC%88%E6%8C%89%E7%B1%BB%E5%88%AB%E5%88%97%E5%87%BA%EF%BC%89-5f91f4e9-7b42-46d2-9bd1-63f26a86c0eb?ui=zh-CN&rs=zh-CN&ad=CN) 

## 0x01 语法说明

都知道学会了英语语法，再加上大量的词汇基础，就算基本掌握了英语了。类似的要使用vba，也要入乡随俗，了解他的构成，简单的说vba包含`数据类型`、`变量&常量`、`对象`和常用的`语句结构`。

不过呢在量和复杂度上远低于英语，不用那么痛苦的记单词了，所以vba其实很简单的。熟悉了规则之后剩下就是查官方函数啦，查Excel提供的可操作对象啦。

顺带一提的是，函数其实也很容易理解，方便使用。拿到一个函数，例如`sum`，只要知道它是求多个数的和就够了，剩下的就是用了。例如`sum(10,9)`结果就是`10`了。函数的一大好处就是隐藏具体实现细节，提供简洁的使用方法。


### 数据和数据类型

Excel里的每一个单元格都是一个`数据`，无论是数字、字母或标点都是数据。对数据排排队，吃果果，对不同的数据扔到不同的篮子里归类，篮子就是`数据类型`了。

在Excele里面吧，`数据类型`只有`数值`、`文本`、`日期`、`逻辑`或`错误`五种类型。前四种就是最常用的了，错误、对象、变体啥的还没遇到过。数据范围呢也不记，知道多大的数用啥类型就足够了。


| 类型 | 类型名称 | 范围 | 占用空间|声明符号 | 备注|
|--------|-------|-----|--------|-----|----|
| **逻辑型**|
| 布尔 | Boolean|逻辑值True或False|2|
|**数值型**|
|字节| Byte | 0~255的整数|1|
|整数| Integer| -32768~32767|2|%|
|长整数|Long|-2147483648~2147483647|4|&|
|单精度浮点|Single||4|!|
|双精度浮点|Double||4|#|
|货币|Currency||8|@|
|小数|Decimal||14|
|**日期型**|
|日期|Date|日期范围:100/1/1~9999/12/31|8|
|**文本型**|
|变长字符串|String|0~20亿||$|
|定长字符串|String|1~65400||
|**其他**|
|变体型|Variant(数值)|保存任意数值，也可以存储Error,Empty,Nothing,Null等特殊数值|
|对象|Object|引用对象|4|

表1.1 VBA数据类型

补充一点是，数组就像一筐水果，里面可以存不止一个数据。他不是一个具体的数据类型，叫数据结构更合适些。

### 常量和变量

定义后不能被改变的量，就是`常量`；相反的`变量`就能修改具体值。

在vba里，使用一个`变量`要先声明，声明方法如下：

`Dim 变量名 As 数据类型`

变量名，必须字母或汉字开头，不能包含空格、句号、感叹号等。

数据类型，对应上面👆表1.1里的那些

更多的声明方法，跟`Dim`声明的区别是作用范围不同：
```vba
Private v1 As Integer   'v1为私有整形变量
Public v2 As String  'v2为共有字符串变量
Static v3 As Integer  'v3为静态变量,程序结束后值不变

'变量声明之后，就可以赋值和使用了
v1 = 1009
v2 = "1009"
v3 = 1009

'使用类型声明符，可以达到跟上面同样的效果
public v2$  '与 Public v2 As String 效果一样

'声明变量时，不指定具体的类型就变成了Variant类型，根据需要转换数据类型
Dim v4
```

使用数组和对象时，也要声明，这里说下数组的声明
```vba
'确定范围的数组，可以存储b-a+1个数，a、b为整数
Dim 数组名称(a To b) As 数据类型

Dim arr(1 TO 100) As Integer '表示arr可以存储100个整数
arr(100) '表示arr中第100个数据

'不指定a，直接声明时，默认a为0
Dim arr2(100) As Integer '表示arr可以存储101个整数,从0数
arr2(100) '表示arr2中第101个数据

'多维数组
Dim arr3(1 To 3,1 To 3,1 To 3) As Integer '定义了一个三维数组，可以存储3*3*3=27个整数

'动态数组，不确定数组大小时使用
Dim arr4() As Integer '定义arr4为整形动态数组
ReDim arr4(1 To v1)  '设定arr4的大小，不能重新设定arr4的类型

```

除了用`Dim`做常规的数组的声明，还有下面这些声明数组的方式:
```vba
'使用Array函数将已知的数据常量放到数组里
Dim arr As Variant        '定义arr为变体类型
arr = Array(1,1,2,3,5,8,13,21) '将整数存储到arr中,索引默认从0开始

'使用Split函数分隔字符串创建数组
Dim arr2 As Variant
arr2 = Split("hello,world",",") '按,分隔字符串 hello,world 并赋值给arr2

'使用Excel单元格区域创建数组
'这种方式创建的数组，索引默认从1开始
Dim arr3 As Variant
arr3 = Range("A1:C3").Value   '将A1:C3中的数组存储到arr3中
Range("A4:C6").Value= arr3    '将arr3中的数据写入到A4:C6中的区域

```
//TODO 补充操作excel赋值的动图

**数组常用的函数**

|函数名|函数说明|参数说明|示例|
|----|----|
|`UBound(数组名称,多维数组维数)`|数组最大的索引值|
|`LBound(数组名称,多维数组维数)`|数组最小的索引值|



## 0x02 操作对象说明

## 0x03 示例
